generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model User {
  UserID      String      @id @default(uuid()) @db.VarChar(50)
  FirstName   String      @db.VarChar(100)
  LastName    String      @db.VarChar(100)
  DateOfBirth DateTime    @db.Date
  Username    String      @unique(map: "unique_Username") @db.VarChar(100)
  Password    String      @db.VarChar(255)
  Role        String      @db.VarChar(50)
  donation    Donation[]
  systemLog   SystemLog[]

  @@index([Username], map: "index_Username")
}

model Donation {
  DonationID  String      @id @default(uuid()) @db.VarChar(50)
  Name        String      @db.VarChar(100)
  Phone       String?     @db.VarChar(20)
  Type        String      @db.VarChar(100)
  Condition   String      @db.VarChar(50)
  Description String?     @db.Text
  Quantity    Int         @default(1)
  Status      String      @default("Pending")
  SubmittedAt DateTime    @default(now())
  UserID      String?     @db.VarChar(50)
  user        User?       @relation(fields: [UserID], references: [UserID])
  inventory   Inventory[]
}

model Inventory {
  InventoryID      String @id @default(uuid()) @db.VarChar(50)
  Category         String @db.VarChar(100)
  Condition        String @db.VarChar(50)
  Quantity         Int    @default(1)
  Status           String @default("Available")
  SourceDonationID String @db.VarChar(50)

  donation     Donation       @relation(fields: [SourceDonationID], references: [DonationID])
  distribution Distribution[]
}

model Distribution {
  DistributionID String   @id @default(uuid()) @db.VarChar(50)
  InventoryID    String   @db.VarChar(50)
  Recipient      String   @db.VarChar(100)
  Quantity       Int
  Date           DateTime @default(now())

  inventory Inventory @relation(fields: [InventoryID], references: [InventoryID])
}

model SystemLog {
  LogID     String   @id @default(uuid()) @db.VarChar(50)
  UserID    String?  @db.VarChar(50)
  Action    String   @db.VarChar(255)
  Status    String   @db.VarChar(50)
  Timestamp DateTime @default(now())

  user User? @relation(fields: [UserID], references: [UserID])
}
